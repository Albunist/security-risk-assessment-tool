<!DOCTYPE html>
<html>
<head>  
    <meta charset="UTF-8">
    <meta http-equiv="Content-Security-Policy" content="script-src 'self' 'unsafe-inline';" />

    <link rel="stylesheet" type="text/css" href="./global styles/global-styles.css">
    <link rel="stylesheet" type="text/css" href="./styles.css">
    <link rel="stylesheet" type="text/css" href="./tabs/Welcome/styles.css">
    <link rel="stylesheet" type="text/css" href="./tabs/Project Context/styles.css">
    <link rel="stylesheet" type="text/css" href="./tabs/Business Assets/styles.css">
    <link rel="stylesheet" type="text/css" href="./tabs/Supporting Assets/styles.css">
    <link rel="stylesheet" type="text/css" href="./tabs/Risks/styles.css">
    <link href="../../node_modules/tabulator-tables/dist/css/tabulator.min.css" rel="stylesheet">

    <!-- npm modules (minified) -->
    <script src="../../node_modules/jquery/dist/jquery.min.js"></script>
    <script src="../../node_modules/tinymce/tinymce.min.js" referrerpolicy="origin"></script>
    <script src="../../node_modules/tabulator-tables/dist/js/tabulator.min.js"></script>
</head>
<body>

    <!-- <p>Current theme source: <strong id="theme-source">System</strong></p> -->

    <!-- <button id="toggle-dark-mode">Toggle Dark Mode</button>
    <button id="reset-to-system">Reset to System Theme</button>
    <br></br> -->

    <div class="wrapper">
      <div class="buttonWrapper">
        <button class="tab-button active" data-id="welcome">Welcome</button>
        <button class="tab-button" data-id="project-context">Project Context</button>
        <button class="tab-button" data-id="business-assets">Business Assets</button>
        <button class="tab-button" data-id="supporting-assets">Supporting Assets</button>
        <button class="tab-button" data-id="risks">Risks</button>
        <button class="tab-button" data-id="vulnerabilities">Vulnerabilities</button>
        <button class="tab-button" data-id="isra-report">ISRA Report</button>
      </div>

      <div class="contentWrapper">
        
        <div class="content active" id="welcome">
        </div>

        <div class="content" id="project-context">  
        </div>
        
        <div class="content" id="business-assets">
        </div>
        
        <div class="content" id="supporting-assets">
        </div>

        <div class="content" id="risks">
          <header>Risks</header>

          <div class="add-delete-container">
            <button class="addDelete">Add</button> | <button  class="addDelete">Delete</button>
          </div>
          <div class="table">
            <div class="checkbox" id="risks__table__checkboxes"></div>
            <div id="risks__table"></div>
          </div>
          <section id="risks__risk__description">
            <div>
              <h1>Risk description</h1>
              <h1>Risk id: <span class="riskId"></span></h1>
            </div>

            <section id="risk__automatic_riskname">
              <p>Risk Name: As a threat agent, I can Threat the Business Asset compromising the Supporting Asset in
                order to Motivation, by exploiting the Vulnerability.
              </p>
              
              <div id="riskName">
                <p class="riskname"></p>
                <button>Replace with Manual Risk Name</button>
              </div id="riskName">

              <div id="risk__manual__riskName">
                <input type="text" style="width: 100%;">
                <button>Replace with Automatic Risk Name</button>
              </div>
              
              <div class="risk__flex">
                <div>
                  <label for="risk__threatAgent">As a Threat Agent</label>
                  <select id="risk__threatAgent" name="risk__threatAgent">
                    <option value="" selected>Select...</option>
                    <option value="Insider">Insider</option>
                    <option value="Criminal">Criminal</option>
                    <option value="Competitor">Competitor</option>
                    <option value="Criminal organization">Criminal organization</option>
                    <option value="Government agency">Government agency</option>
                    <option value="Researcher">Researcher</option>
                    <option value="Activist">Activist</option>
                    <option value="Script Kiddy">Script Kiddy</option>
                    <option value="User">User</option>
                    <option value="R&D Employee">R&D Employee</option>
                    <option value="Operationnal Employee">Operationnal Employee</option>
                    <option value="Maintenance Employee">Maintenance Employee</option>
                    <option value="IT Employee">IT Employee</option>
                  </select>
                  <textarea class="rich-text" id="risk__threatAgent__rich-text"></textarea>
                </div>
                <div>
                  <label for="risk__threat">I can Threat</label>
                  <select id="risk__threat" name="risk__threat">
                    <option value="" selected>Select...</option>
                    <option value="lose">lose</option>
                    <option value="spoof">spoof</option>
                    <option value="tamper with">tamper with</option>
                    <option value="repudiate">repudiate</option>
                    <option value="disclose">disclose</option>
                    <option value="steal">steal</option>
                    <option value="deny access to">deny access to</option>
                    <option value="gain an unauthorized access to">gain an unauthorized access to</option>
                    <option value="flood">flood</option>
                  </select>
                  <textarea class="rich-text" id="risk__threat__rich-text"></textarea>
                </div>
              </div>

              <div class="risk__flex">
                <div>
                  <label for="risk__businessAsset">The Business Asset</label>
                  <select id="risk__businessAsset" name="risk__businessAsset"></select>
                </div>
                <div>
                  <label for="risk__supportingAsset">Compromising the Supporting Asset</label>
                  <select id="risk__supportingAsset" name="risk__supportingAsset"></select>
                </div>
              </div>
              
              <div>
                <div style="display: flex; flex-direction: column;">
                  <label for="risk__motivation">In order to Motivation</label>
                  <input type="text" name="risk__motivation" id="risk__motivation">
                  <textarea class="rich-text" id="risk__motivation__rich-text"></textarea>
                </div>
              </div>
            </section>
          </section>

          <section id="risks__risk__evaluation">
            <h1>Risk evaluation</h1>

            <div>
              <h2>Likelihood evaluation</h2>
              <p>Chance for a threat agent to successfully attack the business asset based on resources, skills, opportunity and motivation</p>

              <div id="risk__simple__evaluation">
                <button>Replace with OWASP Likelihood Evaluation Method</button>
                <select name="risk__likelihood" id="risk__likelihood">
                  <option value="4">Very High</option>
                  <option value="3">High</option>
                  <option value="2">Medium</option>
                  <option value="1">Low</option>
                </select>
              </div>

              <div id="risk__likehood__table">
                <button>Replace with Simple Likelihood Evaluation Method</button>
                <div>
                  <p>How technically skilled is this group of threat agents?</p>
                  <select name="risk__skillLevel" id="risk__skillLevel">
                    <option value="null">Select...</option>
                    <option value="9">No technical skill</option>
                    <option value="6">Some technical skills</option>
                    <option value="5">Advanced computer skills</option>
                    <option value="3">Network and programming skills</option>
                    <option value="1">Security penetration skills</option>
                  </select>
                </div>
                <div>
                  <p>How motivated is this group of threat agents to find and exploit this vulnerability?</p>
                  <select name="risk__reward" id="risk__reward">
                    <option value="null">Select...</option>
                    <option value="9">High reward</option>
                    <option value="4">Possible reward</option>
                    <option value="1">Low or no reward</option>
                  </select>
                </div>
                <div>
                  <p>What resources and opportunities are required for this group of threat agents to find and exploit this vulnerability?</p>
                  <select name="risk__accessResources" id="risk__accessResources">
                    <option value="null">Select...</option>
                    <option value="9">No access or resources required</option>
                    <option value="7">Some access or resources required</option>
                    <option value="4">Special access or resources required</option>
                    <option value="0">Full access or expensive resources required</option>
                  </select>
                </div>
                <div>
                  <p>How large is this group of threat agents?</p>
                  <select name="risk__size" id="risk__size">
                    <option value="null">Select...</option>
                    <option value="9">Anonymous Internet users</option>
                    <option value="6">Authenticated users</option>
                    <option value="5">Partners</option>
                    <option value="4">Intranet users</option>
                    <option value="2">Developers/system administrators</option>
                  </select>
                </div>
                <div>
                  <p>How likely is an exploit to be detected?</p>
                  <select name="risk__intrusionDetection" id="risk__intrusionDetection">
                    <option value="null">Select...</option>
                    <option value="9">Not logged</option>
                    <option value="8">Logged without review</option>
                    <option value="3">Logged and reviewed</option>
                    <option value="1">Active detection in application</option>
                  </select>
                </div>
                <div>
                  <p>What is the probability of occurrence?</p>
                  <select name="risk__occurrence" id="risk__occurrence">
                    <option value="null">Select...</option>
                    <option value="9">Very high (it will happen)</option>
                    <option value="7">High (it already happened in Thales DIS)</option>
                    <option value="5">Medium (it already happened in similar companies)</option>
                    <option value="3">Low (it happened)</option>
                    <option value="1">Very low</option>
                  </select>
                </div>
                <div id="risk__occurrence__threatFactor__table">
                  <table style="border: 0;">
                    <tbody>
                      <tr>
                        <td rowspan="5">Occurrence</td>
                      </tr>
                      <tr>
                        <td>Very High</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                      </tr>
                      <tr>
                        <td>High</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                      </tr>
                      <tr>
                        <td>Medium</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                      </tr>
                      <tr>
                        <td>Low</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                      </tr>
                      <tr>
                        <td colspan="2" style="border: 0;"></td>
                        <td>Low</td>
                        <td>Medium</td>
                        <td>High</td>
                        <td>Very High</td>
                      </tr>
                      <tr>
                        <td colspan="2" style="border: 0;"></td>
                        <td colspan="4">Threat Factor</td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>

              <div>
                <p>Justify your likelihood evaluation:</p>
                <textarea class="rich-text" id="risk__likelihood__details" cols="30" rows="20"></textarea>
              </div>

            </div>

            <div>
              <h2>Impact evaluation</h2>
              <p>Select the Business Asset security properties you want to take into account for this risk evaluation:</p>
              <table id="risk__evaluation__table">
                <thead>
                  <tr>
                    <th>Business Asset Security Properties</th>
                    <th>Value</th>
                    <th>Take into account</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>Confidentialty</td>
                    <td></td>
                    <td><input type="checkbox" id="risk__confidentialty"></td>
                  </tr>
                  <tr>
                    <td>Integrity</td>
                    <td></td>
                    <td><input type="checkbox" id="risk__integrity"></td>
                  </tr>
                  <tr>
                    <td>Availability</td>
                    <td></td>
                    <td><input type="checkbox" id="risk__availability"></td>
                  </tr>
                  <tr>
                    <td>Authenticity</td>
                    <td></td>
                    <td><input type="checkbox" id="risk__authenticity"></td>
                  </tr>
                  <tr>
                    <td>Authorization</td>
                    <td></td>
                    <td><input type="checkbox" id="risk__authorization"></td>
                  </tr>
                  <tr>
                    <td>Non Repudiation</td>
                    <td></td>
                    <td><input type="checkbox" id="risk__nonrepudiation"></td>
                  </tr>
                </tbody>
              </table>
            </div>

            <div>
              <h2>Vulnerability evaluation</h2>
              <p>What is the vulnerability on your supporting asset that should be taken into account for this risk?</p>
              <button name="Go to vulnerabilities view">Go to vulnerabilities view</button>
              <section id="risks__vulnerability__evaluation"></section>
            </div>
          </section>
          <footer></footer>
        </div>

        <div class="content" id="vulnerabilities">
          <header>Vulnerabilities</header>
          <footer></footer>
        </div>

        <div class="content" id="isra-report">
          <header>ISRA Report</header>
          <footer></footer>
        </div>
        
      </div>
      
    </div>

    <script src="renderer.js"></script>
    <script src="./tabs/Welcome/renderer.js"></script>
    <script src="./tabs/Project Context/renderer.js"></script>
    <script src="./tabs/Business Assets/renderer.js"></script>
    <script src="./tabs/Supporting Assets/renderer.js"></script>
    <script src="./tabs/Risks/renderer.js"></script>
  </body>
</body>
</html>

